<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Debug Logs</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet"/>
  <script>
    function loadDebugLogs() {
      const adSlotId = localStorage.getItem('adSlotId');
      const bidHandler = localStorage.getItem('bidHandler');
      const searchTime = localStorage.getItem('searchTime');

      if (!adSlotId || !bidHandler) {
        document.getElementById('searchDetails').innerHTML = `<p class="text-danger">Missing session data. Please <a href="debug-setup.html">go back</a>.</p>`;
        return;
      }

      const requestPayload = JSON.stringify({ imp: [{ tagid: adSlotId }], handler: bidHandler }, null, 2);
      const responsePayload = JSON.stringify({ bid: [{ price: 5.0, handler: bidHandler }] }, null, 2);

      document.getElementById('searchDetails').innerHTML = `
        <p><strong>Ad Slot ID:</strong> ${adSlotId}</p>
        <p><strong>Bid Handler:</strong> ${bidHandler}</p>
        <p><strong>Time:</strong> ${searchTime}</p>`;
      document.getElementById('requestPayload').textContent = requestPayload;
      document.getElementById('responsePayload').textContent = responsePayload;
    }

    window.onload = loadDebugLogs;
  </script>
</head>
<body class="bg-light">
  <div class="container mt-5">
    <div class="card shadow-lg p-4">
      <h2 class="mb-4">Debug Session Logs</h2>
      <div id="searchDetails" class="mb-3"></div>

      <div class="mb-3">
        <button class="btn btn-outline-primary w-100" data-bs-toggle="collapse" data-bs-target="#reqCollapse">
          <i class="bi bi-arrow-down"></i> Request Payload
        </button>
        <div id="reqCollapse" class="collapse mt-2">
          <pre id="requestPayload" class="bg-light p-3 border rounded">Loading...</pre>
        </div>
      </div>

      <div class="mb-3">
        <button class="btn btn-outline-primary w-100" data-bs-toggle="collapse" data-bs-target="#resCollapse">
          <i class="bi bi-arrow-down"></i> Response Payload
        </button>
        <div id="resCollapse" class="collapse mt-2">
          <pre id="responsePayload" class="bg-light p-3 border rounded">Loading...</pre>
        </div>
      </div>

      <a href="debug-setup.html" class="btn btn-secondary w-100 mt-3">‚Üê Back to Setup</a>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
